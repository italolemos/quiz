 var quiztitle = "Dengue Quiz";


  var quiz = [

        {
            "question" : "Qual doença é transmitida pelo mosquito Aedes aegypti?",
            "choices" : [
                                    "Catapora",
                                    "Sarampo",
                                    "Chikungunya",
                                    "Caxumba"
                                ],
            "correct" : "Chikungunya",
            "id":"0"
        },

        {
            "question" : "Qual estação do ano é mais frequente para o proliferação do mosquito da dengue?",
            "choices" : [
                                    "Primavera",
                                    "Verão",
                                    "Outono",
                                    "Inverno"
                                    
                                ],
            "correct" : "Verão",
            "id":"1"
        },

        {
            "question" : "Como a dengue é transmitida?",
            "choices" : [
                                    "Pela picada do macho do mosquito Aedes aegypti",
                                    "Pela picada da fêmea do mosquito Aedes aegypti",
                                    "Pela picada tanto do macho quanto da fêmea do mosquito Aedes aegypti",
                                    "Pela picada do barbeiro macho contaminado pelo protozoário Trypanosoma cruzi",
                                    "Pela picada do barbeiro fêmea contaminado pelo protozoário Trypanosoma cruzi."
                                ],
            "correct" : "Pela picada da fêmea do mosquito Aedes aegypti",
            "id":"2"
        },
        {
            "question" : "O Aedes aegypti é parecido com o pernilongo comum, mas há diferenças que podem identificá-lo. Uma delas é:",
            "choices" : [
                                    "Corpo escuro com listras brancas",
                                    "Corpo claro com círculos escuros",
                                    "Zunido mais agudo",
                                    "Zunido mais grave",
                                    "Corpo ovalado, em formato de feijão"
                                ],
            "correct" : "Corpo escuro com listras brancas",
            "id":"3"
        },
        {
            "question" : "Não é um sintoma da Dengue:",
            "choices" : [
                                    "Febre",
                                    "Dor de cabeça",
                                    "Fraqueza",
                                    "Manchas Vermelhas",
                                    "Dor de ouvido"
                                ],
            "correct" : "Dor de ouvido",
            "id":"4"
        },
        {
            "question" : "Como conter a proliferação do mosquito transmissor da dengue?",
            "choices" : [
                                    "Manter a caixa dágua sempre aberta",
                                    "Deixar água acumulada em lajes e calhas",
                                    "Encher de areia os pratos de vasos de flores"
                                ],
            "correct" : "Encher de areia os pratos de vasos de flores",
            "id":"5"
        },
        {
            "question" : "Como se chama o mosquito que transmite o vírus da Dengue?",
            "choices" : [
                                    "Zangão",
                                    "Aedes Aegypti"
                                    
                                ],
            "correct" : "Aedes Aegypti",
            "id":"6"
        },
         {
            "question" : "Quais etapas de desenvolvimento passa o mosquito até chegar à etapa adulta",
            "choices" : [
                                    "larva, mosquito",
                                    "ovo, larva e pupa",
                                    "pupa, ovo, mosquito"
                                ],
            "correct" : "ovo, larva e pupa",
            "id":"7"
        },

         {
            "question" : "Existe uma vacina contra a dengue?",
            "choices" : [
                                    "Sim",
                                    "Não"
                                ],
            "correct" : "Não",
            "id":"8"
        },
         {
            "question" : "Como uma pessoa pode saber se teve ou tem dengue?",
            "choices" : [
                                    "Através de consulta na internet",
                                    "Através do exame de sangue feito em laboratório"

                                ],
            "correct" : "Através do exame de sangue feito em laboratório",
            "id":"9"
        },
         {
            "question" : "Como previnir a dengue? ",
            "choices" : [
                                    "Eliminar recipientes que possam acumular água",
                                    "Manter água parada em baldes"


                                ],
            "correct" : "Eliminar recipientes que possam acumular água",
            "id":"10"
        },
         {
            "question" : "Quanto tempo pode durar o ovo do mosquito, em condições favoráveis?",
            "choices" : [
                                    "5 dias",
                                    "6 meses",
                                    "7 dias",
                                    "1 mês"
                                ],
            "correct" : "6 meses",
            "id":"11"
        },
         {
            "question" : "Quais dessas doenças são transmitidas pela Aedes aegypti",
            "choices" : [
                                    "Desnutrição, Diarreia, Caxumba",
                                    "Pneumonia, Asma e Cárie",
                                    "Zika, Dengue e Chikungunya"


                                ],
            "correct" : "Zika, Dengue e Chikungunya",
            "id":"12"
        },
         {
            "question" : "Em quais destes lugares podem acumular água parada?",
            "choices" : [
                                    "Pneus velhos, tampas de garrafa, vaso de plantas, caixa d'água",
                                    "Carros, canos fechados e roupas"
                                ],
            "correct" : "Pneus velhos, tampas de garrafa, vaso de plantas, caixa d'água",
            "id":"13"
        },
         {
            "question" : "Quem pode adoecer de dengue?",
            "choices" : [
                                    "Apenas crianças",
                                    "Apenas adultos",
                                    "Qualquer pessoa, adulto ou criança"
                                ],
            "correct" : "Qualquer pessoa, adulto ou criança",
            "id":"14"
        },
         {
            "question" : "Onde se cria o mosquito Aedes aegypti?",
            "choices" : [
                                    "Em lugares com bastante terra ou concreto",
                                    "Em qualquer recipiente que acumule água, seja dentro e/ou ao redor das residências"
                                ],
            "correct" : "Em qualquer recipiente que acumule água, seja dentro e/ou ao redor das residências",
            "id":"15"
        },
         {
            "question" : "O que deve fazer uma pessoa com suspeita de dengue?",
            "choices" : [
                                   "Falar com o vizinho e tomar aspirina",
                                    "Ir ao posto de saúde para ser examinada."
                                ],
            "correct" : "Ir ao posto de saúde para ser examinada.",
            "id":"16"
        },
         {
            "question" : "Quantas patas tem o mosquito?",
            "choices" : [
                                    "Quatro patas",
                                    "Duas patas",
                                    "Seis patas",
                                    "Nove patas"
                                ],
            "correct" : "Seis patas",
            "id":"17"
        },
         {
            "question" : "A fêmea se alimenta de sangue para produzir seus ovos",
            "choices" : [
                                   "Correto",
                                    "Errado"
                                ],
            "correct" : "Correto",
            "id":"18"
        },
         {
            "question" : "Pratinhos de vasos de plantas, vasos de plantas aquáticas, pneus velhos, latas, garrafas, tonéis, caixas d’água são os criadouros mais comuns do mosquito?",
            "choices" : [
                                    "Correto",
                                    "Errado"
                                ],
            "correct" : "Correto",
            "id":"19"
        },

    ];


 var currentquestion = 0,
     score = 0,
     submt = true,
     picked
     aux = 0;

 var arrayPerguntasSelecionadas = [];

 jQuery(document).ready(function ($) {


     function htmlEncode(value) {
         return $(document.createElement('div')).text(value).html();
     }


     function addChoices(choices) {
         if (typeof choices !== "undefined" && $.type(choices) == "array") {
             $('#choice-block').empty();
             for (var i = 0; i < choices.length; i++) {
                 $(document.createElement('li')).addClass('choice choice-box').attr('data-index', i).text(choices[i]).appendTo('#choice-block');
             }
         }
     }

     function nextQuestion() {
         submt = true;
         $('#explanation').empty();
         $('#question').text(quiz[currentquestion]['question']);
         // $('#pager').text('' + Number(aux+1) + ' de 5');
         if (quiz[currentquestion].hasOwnProperty('image') && quiz[currentquestion]['image'] != "") {
             if ($('#question-image').length == 0) {
                 $(document.createElement('img')).addClass('question-image').attr('id', 'question-image').attr('src', quiz[currentquestion]['image']).attr('alt', htmlEncode(quiz[currentquestion]['question'])).insertAfter('#question');
             } else {
                 $('#question-image').attr('src', quiz[currentquestion]['image']).attr('alt', htmlEncode(quiz[currentquestion]['question']));
             }
         } else {
             $('#question-image').remove();
         }
         addChoices(quiz[currentquestion]['choices']);
         setupButtons();


     }


     function processQuestion(choice) {

         if (quiz[currentquestion]['choices'][choice] == quiz[currentquestion]['correct']) {
             $('.choice').eq(choice).css({
                 'background-color': '#AAF606'
             });
             score++;
         } else {
             $('.choice').eq(choice).css({
                 'background-color': '#F63506'
             });
         }
         aux++;

         currentquestion = Math.floor((Math.random() * 19));

         while(arrayPerguntasSelecionadas.indexOf(quiz[currentquestion].id) !== -1){
            //alert("tem");
            currentquestion = Math.floor((Math.random() * 19));
         }
         arrayPerguntasSelecionadas.push(quiz[currentquestion].id);






         $('#submitbutton').html('Próxima Pergunta &raquo;').on('click', function () {
             if (aux >= 5) {
                 endQuiz();
             } else {
                 $(this).text('Verificar Resposta').css({
                     'color': '#222'
                 }).off('click');
                 nextQuestion();
             }
         })
     }


     function setupButtons() {
         $('.choice').on('mouseover', function () {
             $(this).css({
                 'background-color': 'rgba(255,255,255,100%)'
             });
         });
         $('.choice').on('mouseout', function () {
             $(this).css({
                 'background-color': 'rgba(255,255,255,100%)'
             });
         })
         $('.choice').on('click', function () {
             picked = $(this).attr('data-index');
             $('.choice').removeAttr('style').off('mouseout mouseover');
             $(this).css({
                 'border-color': '#222',
                 'font-weight': 700,
                 'background-color': '#c1c1c1'
             });
             if (submt) {
                 submt = false;
                 $('#submitbutton').css({
                     'color': '#000'
                 }).on('click', function () {
                     $('.choice').off('click');
                     $(this).off('click');
                     processQuestion(picked);
                 });
             }
         })
     }


     function endQuiz() {
         $('#explanation').empty();
         $('#question').empty();
         $('#choice-block').empty();
         $('#submitbutton').remove();
         $('#question').text("Você acertou " + score + " perguntas.");
         $(document.createElement('h2')).css({
             'text-align': 'center',
             'font-size': '4em'
         }).text(Math.round(score / 5 * 100) + '%').insertAfter('#question');
         var percentagemAcerto = Math.round(score / 5 * 100);
         if(percentagemAcerto >=60){
         $('<a href="quizFase1.html"><img src="img/rsz_refazer.png"></a>').attr({id: 'submitbutton'}).css({
                 'position':'absolute',
                 'left':'610px',
                 'top':'400px',
                }).insertAfter('#question');
         }else{
            $('<a href="quizFase1.html"><img src="img/rsz_refazer.png"></a>').attr({id: 'submitbutton'}).css({
                 'position':'absolute',
                 'left':'610px',
                 'top':'400px',
                }).insertAfter('#question');
         }


     }




     function init() {
        currentquestion = Math.floor((Math.random() * 19));
        arrayPerguntasSelecionadas.push(quiz[currentquestion].id);

         //add title
         if (typeof quiztitle !== "undefined" && $.type(quiztitle) === "string") {
             $(document.createElement('h1')).text(quiztitle).appendTo('#frame');
         } else {
             $(document.createElement('h1')).text("Quiz").appendTo('#frame');
         }

         //add pager and questions
         if (typeof quiz !== "undefined" && $.type(quiz) === "array") {
             //add pager
             $(document.createElement('p')).addClass('pager').attr('id', 'pager').text('').appendTo('#frame');
             //add first question
             $(document.createElement('h2')).addClass('question').attr('id', 'question').text(quiz[currentquestion]['question']).appendTo('#frame');
             //add image if present
            /* if (quiz[0].hasOwnProperty('image') && quiz[0]['image'] != "") {
                 $(document.createElement('img')).addClass('question-image').attr('id', 'question-image').attr('src', quiz[0]['image']).attr('alt', htmlEncode(quiz[0]['question'])).appendTo('#frame');
             }*/
             $(document.createElement('p')).addClass('explanation').attr('id', 'explanation').html('&nbsp;').appendTo('#frame');

             //questions holder
             $(document.createElement('ul')).attr('id', 'choice-block').appendTo('#frame');

             //add choices
             addChoices(quiz[currentquestion]['choices']);

             //add submit button
             $(document.createElement('div')).addClass('choice-box').attr('id', 'submitbutton').text('Verificar Resposta').css({
                 'font-weight': 700,
                 'color': '#222',
                 'padding': '20px 0',
                 'width':'200px'
             }).appendTo('#frame');

             setupButtons();

         }
     }

     init();
 });
